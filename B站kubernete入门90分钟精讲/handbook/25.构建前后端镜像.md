### 构建后端镜像

在项目的根目录下创建**dockerfile**文件。

```dockerfile
#编译
FROM maven AS build
WORKDIR /build/app
#将本地的maven目录装载到容器中的maven目录下，这样就不用重复下载依赖的jar包了
#VOLUME ~/.m2 /root/.m2
COPY .. .
RUN mvn clean package

#打包
FROM openjdk:8u342-jre
WORKDIR /app/ruoyi
COPY --from=build /build/app/ruoyi-admin/target/ruoyi-admin.jar .
EXPOSE 8080
ENTRYPOINT ["java","-jar","ruoyi-admin.jar"]
```

```bash
#打包镜像
docker build -t ruoyi-admin:v3.8 .
```

### 构建前端镜像

> **注意事项：**
> 1.编译前端代码需要使用Node.js, 强烈建议在容器中进行编译。
> 2.对于不了解前端的同学，在本机使用Node编译极大概率会出错。
> 3.推荐使用Node 14，最新版本的Node会报错。
> 4.执行命令打包到正式环境，不要打包预编译环境，不然部署之后运行会报错 。

在**ruoyi-ui**目录下创建**dockerfile**

```dockerfile
FROM node:14-alpine AS build
WORKDIR /build/ruoyi-ui
COPY . .
# 安装依赖并打包到正式环境
RUN npm install --registry=https://registry.npmmirror.com && npm run build:prod

FROM nginx:1.22
WORKDIR /app/ruoyi-ui
COPY --from=build /build/ruoyi-ui/dist .
EXPOSE 80
```
```bash
docker build -t ruoyi-ui:v3.8 .
```

